
프로세스 동기화란?

멀티프로세싱 환경에서 여러 프로세스가 동시에 실행될 때, 공유 자원에 대한 접근을 조정하고 서로 간의 실행 순서를 제어하는 것

중점
- 실행 순서 제어
- 상호 배제



프로세스 동기화가 필요한 이유
1. 무결성 유지
2. 상호 배제
3. 교착 상태 관리
4. 효율적인 자원 분배
5. 올바른 실행및 검증
6. 동기화
7. 확정성(결정성)

임계 구역

임계구역은 여러 프로세스 또는 스레드가 공유 자원에 접근하는 코드의 특정 부분을 의미, 공유 자원에 접근할 때 임계구역을 설정하면 여러 프로세스가 동시에 이 자원에 접근하는걸 방지해 데이터 무결성 유지가 가능
이 문제를 해결하려면 밑 3가지 문제가 해결되어야 한다!

- 상호배제
- 한정된 대기
- 진행

1. 상호배제 1단계 알고리즘

상호 배제 1단계 알고리즘(Turn-based Algorithm)은 두 개의 프로세스가 서로 번갈아 가며 임계구역에 진입하도록 하는 간단한 상호 배제 알고리즘. 이 알고리즘은 두 프로세스가 공유 자원에 동시에 접근하지 않도록 **TURN 변수**를 사용해 관리합니다. 이 방식에서는 TURN 변수를 통해 어느 프로세스가 임계구역에 들어갈 차례인지를 정해줍니다.

 1단계 알고리즘 작동 방식

1. **TURN 변수**: TURN 변수는 현재 어느 프로세스가 임계구역에 들어갈 차례인지 나타냅니다. `TURN = 0`이면 프로세스 P0가 진입할 차례이고, `TURN = 1`이면 프로세스 P1이 진입할 차례.
    
2. **임계구역 진입 조건**: 각 프로세스는 자신의 차례가 될 때까지 기다리며, TURN 변수의 값이 자신의 프로세스 번호와 같으면 임계구역에 진입할 수 있습니다.
    
3. **임계구역 종료 후 TURN 변경**: 임계구역을 벗어난 프로세스는 TURN 값을 상대방 프로세스 번호로 변경하여 상대방이 임계구역에 진입할 수 있도록 합니다.

요약 : turn 을 받을때 까지 기다림, 본인의 차례가오면 공유자원에 접근하여 할일을 마치고 상대에게 차례를 넘김 이를 반복

- 장점: 구현이 매우 단순함
- 단점: 두 프로세스가 **번갈아 가며** 자원에 접근하는 구조이기 때문에 한 프로세스가 임계구역을 필요로 하지 않아도 상대방 프로세스가 기다려야 하는 **비효율성**이 발생


2. 상호배제 2단계 알고리즘

**상호 배제 2단계 알고리즘(Flag-based Algorithm)**은 두 프로세스가 공유 자원에 동시에 접근하지 않도록 `FLAG` 배열만을 사용해 구현합니다. `FLAG` 배열을 통해 각 프로세스가 임계구역에 들어가려는지 여부를 표시하고, 두 프로세스가 동시에 접근하는 것을 방지합니다.


 2단계 알고리즘 작동 방식

- **FLAG 배열**: 두 프로세스(P0와 P1) 각각이 `FLAG` 배열의 인덱스에 자기 상태를 표시합니다.
    - `FLAG[0]`은 프로세스 P0의 상태를, `FLAG[1]`은 프로세스 P1의 상태를 나타냅니다.
    - `FLAG` 값이 `true`이면 해당 프로세스가 임계구역에 진입하려고 하는 상태임을 의미합니다.

 알고리즘 동작 과정

1. 프로세스가 임계구역에 들어가기를 원하면 해당 `FLAG` 값을 `true`로 설정합니다.
2. 이후 상대방 프로세스의 `FLAG` 값이 `true`인지 확인합니다.
    - 상대방이 임계구역에 들어가려는 상태이면 기다립니다.
3. 상대방 프로세스의 `FLAG` 값이 `false`이면 임계구역에 들어갈 수 있습니다.
4. 임계구역에서 나올 때 자신의 `FLAG` 값을 `false`로 설정하여 임계구역 진입 의사를 철회합니다.

요약 : 본인의 flag를 참으로 놓으면서 진입의사 표시, 상대의 자원접근이 종료되고 상대방  flag 가 false 가 되자마자 진입

- **장점**:
    - 단순히 `FLAG` 배열만으로 상호 배제를 구현할 수 있어 구조가 간단합니다.
    - 두 프로세스가 동시에 임계구역에 들어가지 않도록 합니다.
- **단점**:
    - **기아 상태(Starvation)** 발생 가능성: 두 프로세스가 동시에 임계구역에 진입하려고 하면 무한 대기 상태가 발생할 수 있습니다.
    - **데드락 가능성**: 상대방이 임계구역을 포기하지 않으면 무한 대기가 발생할 수 있습니다.


3. 3단계 알고리즘

상호배제 3단계 데커 알고리즘(Dekker's Algorithm)**은 두 개의 프로세스가 공유 자원에 동시 접근하는 것을 방지하는 상호 배제 알고리즘으로, **상호 배제, 진행, 유한 대기**를 보장하는 최초의 알고리즘 중 하나입니다. 데커 알고리즘은 두 개의 프로세스가 서로 번갈아 임계구역에 들어갈 수 있도록 `FLAG` 배열과 `TURN` 변수를 조합해 상호 배제를 구현합니다.

1. **FLAG 배열**: 각 프로세스가 임계구역에 들어가고자 하는 의사를 나타냅니다.
    
    - `FLAG[0]`: 프로세스 P0의 진입 의사.
    - `FLAG[1]`: 프로세스 P1의 진입 의사.
    - `FLAG[i]`가 `true`면 프로세스 `i`가 임계구역에 진입하려고 하는 상태입니다.
2. **TURN 변수**: 두 프로세스가 동시에 임계구역에 들어가려고 할 때, 누구에게 우선권이 있는지를 나타냅니다.
    
    - `TURN = 0`이면 P0에게 우선권이 있고, `TURN = 1`이면 P1에게 우선권이 있습니다.

### 데커 알고리즘 작동 방식

데커 알고리즘은 각 프로세스가 자신의 `FLAG`를 통해 임계구역 진입 의사를 표시하고, **상대방의 `FLAG`와 `TURN`을 확인하여 임계구역에 진입할 수 있는지 결정**합니다. 


 데커 알고리즘의 주요 구성 요소
1. **FLAG 배열**: 각 프로세스가 임계구역에 들어가고자 하는 의사를 나타냅니다.
    
    - `FLAG[0]`: 프로세스 P0의 진입 의사.
    - `FLAG[1]`: 프로세스 P1의 진입 의사.
    - `FLAG[i]`가 `true`면 프로세스 `i`가 임계구역에 진입하려고 하는 상태입니다.
2. **TURN 변수**: 두 프로세스가 동시에 임계구역에 들어가려고 할 때, 누구에게 우선권이 있는지를 나타냅니다.
    
    - `TURN = 0`이면 P0에게 우선권이 있고, `TURN = 1`이면 P1에게 우선권이 있습니다.
요약 : 2단계 알고리즘에서 둘 모두가 true 일 경우 생기는 교착상태 예방을 위하여 turn 개념을 도입한 알고리즘, flag가 true 면 진입하되, 상대의 진입의사를 확인, 상대의 진입의사가 참이면 내 우선권(turn)를 철회하고, 대기, 상대의 진입의사가 없으면 내가 진행

- **장점**:
    
    - **상호 배제**: 두 프로세스가 동시에 임계구역에 진입할 수 없습니다.
    - **진행 보장**: 임계구역에 진입할 프로세스가 없다면, 대기 중인 프로세스는 임계구역에 들어갈 수 있습니다.
    - **유한 대기 보장**: 특정 프로세스가 임계구역에 진입하기 위해 무한히 대기하지 않도록, TURN 변수를 사용해 번갈아가며 우선권을 부여합니다.
- **단점**:
    
    - 두 프로세스에만 적용 가능한 알고리즘입니다. 여러 프로세스에 대한 확장이 어렵습니다.
    - 구현이 다소 복잡하여 실수할 가능성이 있으며, 프로세스 수가 늘어날수록 효율이 떨어집니다.

