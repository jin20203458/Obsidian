지금까지의 실습에서는 디폴트로 주어진 좌표 공간을 그냥 사용했다. -1 ~ 1 사이의 좁은 공간에 물체를 배치했으면 위치도 항상 중앙의 원점이었다. 이제 좌표 공간과 물체에 변화를 주어 보자. 지금까지는 입체 확인을 위해 회전 변환만 사용해 보았는데 이 절에서 여러 가지 변환을 실습해 볼 것이다.

3차원 공간에 배치된 물체는 이동, 확대, 회전 등 여러 가지로 변화를 줄 수 있으며 보는 각도에 따라 모양이 달라지기도 한다. 좌표 공간 자체도 범위와 증감 방향에 대해 원하는대로 지정할 수 있다. 또 3차원 공간의 장면도 결국은 모니터나 지면에 출력해야 하므로 2차원으로 바꿔야 한다. 이 각각의 과정에서 복잡한 변환이 발생한다. 전체적인 변환 과정은 다음과 같다.

![[Pasted image 20240612001520.png]]

void glMatrixMode(GLenum mode);

인수로 대상 행렬을 지정하며 이를 행렬 모드라고 한다. 이 함수로 지정한 행렬은 이후의 모든 행렬 연산의 대상이 된다. 물론 다른 행렬을 조작하고 싶을 때는 언제든지 행렬 모드를 바꿀 수 있다. 다음과 같은 행렬 모드가 있는데 주로 모델뷰 행렬이나 투영 행렬이 변환 대상이다. 디폴트는 모델뷰 행렬이다.

|열거형|설명|
|---|---|
|GL_MODELVIEW|모델 뷰 변환 행렬. 이 값이 디폴트이다.|
|GL_PROJECTION|투영 행렬|
|GL_TEXTURE|텍스처 행렬|
|GL_COLOR|색상 행렬. 단 이 기능은 ARB_imaging 확장 기능이 지원되어야 한다.|
현재 행렬이 무엇인지를 알아내려면 glGet 함수로 GL_MATRIX_MODE를 전달한다. 현재 행렬을 지정한 후 다양한 행렬 조작을 할 수 있다. 앞으로 여러 가지 변환 함수들을 배우겠지만 일단 대표적으로 다음 함수 하나에 대해 알아 보자.

void glLoadIdentity(void);

이 함수는 현재 행렬을 단위 행렬로 만든다. 

단위 행렬은 우하향 대각선 방향만 1이고 나머지 요소는 모두 0인 행렬로서 임의의 행렬을 곱해도 원래 행렬이 계산되는 특수한 행렬이다. 

곰셉의 1, 덧셈의 0과 같은 항등원으로서 연산을 해도 처음값이 유지된다. 현재 행렬을 단위 행렬로 만든다는 것은 **행렬을 리셋한다는 뜻이며 이는 곧 어떠한 변환도 하지 않는다는 뜻이다.** 지금까지 입체 확인을 위해 회전 기능을 사용했던 모든 예제를 보면 다음 두 행의 코드가 있다.

glMatrixMode(GL_MODELVIEW);
glLoadIdentity();

이 코드는 모델뷰 행렬을 리셋한다. DoDisplay를 이전에 실행했을 때 적용했던 회전값을 무시하고 다시 설정하기 위해 리셋을 해야 한다. 이 리셋 코드가 없으면 회전이 계속 누적 적용되어 원하는 대로 회전되지 않는다. 그림을 그리기 전에 화면을 지우는 것과 마찬가지로 **행렬을 사용하기 전에 리셋을 먼저 해야 한다.**

#### 관측 변환

**관측(Viewing)이란 3차원 공간의 장면을 바라본다는 뜻이다.**
관측 변환은 장면을 바라보는 사용자의 위치나 시점, 각도를 변경하는 변환이다. 같은 장면이라도 어디서 어떤 각도로 바라 보는가에 따라 모양이 완전히 달라진다. 마치 장면을 촬영하는 카메라를 이리 저리 옮기는 기법과 유사해서 카메라 변환이라고도 한다. 관측 지점은 다음 함수로 지정한다.

void gluLookAt(
    GLdouble eyeX, GLdouble eyeY, GLdouble eyeZ,
    GLdouble centerX, GLdouble centerY, GLdouble centerZ,
    GLdouble upX, GLdouble upY, GLdouble upZ
);

보다시피 이 함수는 gl의 함수가 아니라 glu의 유틸리티 함수이다. 왜냐하면 이 함수가 아니어도 동일한 효과를 낼 수 있는 방법이 있기 때문이다. 인수가 굉장히 많은 것처럼 보이는데 세 가지 관점에 대해 x, y, z 각 세쌍씩이므로 총 9개의 인수가 필요하다.

eye 좌표는 시선의 좌표 즉, 관찰자의 위치를 나타내는 좌표이다. center는 관찰자가 바라보고 있는 좌표이다. up은 위쪽을 가리키는 업 벡터를 나타낸다. 카메라로 장면을 촬영하고 있다면 카메라가 있는 곳이 eye 좌표이고 카메라가 초점으로 정한 부분이 center 좌표이며 카메라의 각도가 up 벡터이다. 규칙상 up 벡터는 시선과 평행해서는 안된다.

관측지점을 옮기는것은 곧 물체가 멀어진다는 것이다. (나로부터)
내가 멀어지나 물체가 멀어지나 ...

### 모델링 변환

모델링(Modeling) 변환은 3차원 공간에 배치된 물체를 변형한다. 이동, 확대/축소, 회전 등 여러 가지 변환이 있으며 두 가지 이상의 변환을 동시에 적용하기도 한다. 양이 좀 많지만 특별히 어렵지는 않으므로 순서대로 구경만 해 보면 된다.

