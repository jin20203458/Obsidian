### IPA:프로시저 간 분석

**참조:**
[[ASTContext]]
정적 코드 분석에서 IPA는 **프로그램의 여러 함수(또는 프로시저/메서드)에 걸쳐 데이터 흐름, 제어 흐름, 변수 상태 등을 종합적으로 분석**하는 것을 말합니다. 단일 함수 내부만을 보는 것이 아니라, 함수 호출을 따라가면서 프로그램 전체의 동작을 이해하려는 시도입니다.

**IPA가 CSA에서 중요한 이유:**

현대 소프트웨어는 거의 모든 경우 여러 개의 함수로 모듈화되어 있습니다. 특정 함수 내에서 안전하게 보이는 코드가, 다른 함수에서 전달받은 비정상적인 입력이나, 외부 함수 호출로 인해 변경된 전역 상태 때문에 실제로는 문제를 일으킬 수 있습니다. IPA는 이러한 '함수 간'의 상호작용으로 인해 발생하는 문제를 탐지하는 데 필수적입니다.

**CSA에서 IPA의 주요 목표 및 활용:**

1. **정확한 데이터 흐름 분석 (Data Flow Analysis):**
    
    - **소스(Source)에서 싱크(Sink)까지의 추적:** 사용자 입력과 같은 '소스(Source)'에서 데이터가 들어와 안전하지 않은 '싱크(Sink)' (예: 데이터베이스 쿼리, 파일 쓰기, 외부 명령 실행)로 전달될 때, 중간의 여러 함수 호출을 거쳐 어떻게 데이터가 오염되거나 조작되는지 추적합니다. 이는 SQL 인젝션, 크로스 사이트 스크립팅(XSS)과 같은 **보안 취약점을 탐지**하는 데 핵심적입니다.
        
    - **변수 생명주기 추적:** 메모리 할당(`malloc`)이 어느 함수에서 이루어지고, 해당 메모리가 다른 함수로 전달된 후 언제 해제(`free`)되는지 등을 추적하여 **메모리 누수(Memory Leak)**나 **Use-after-Free**와 같은 문제를 탐지합니다.
        
2. **부작용(Side Effects) 분석:**
    
    - 함수가 전역 변수나 다른 함수의 상태를 어떻게 변경하는지 파악합니다. 이는 **불필요한 부작용**이나 **경쟁 조건(Race Condition)**과 같은 동시성 문제를 찾아내는 데 도움이 됩니다.
        
    - `foo()` 함수가 호출될 때마다 특정 리소스 카운터를 증가시킨다면, `foo()`를 호출하는 모든 지점에서 그 카운터가 변경될 수 있음을 IPA를 통해 파악할 수 있습니다.
        
3. **별칭 분석 (Alias Analysis):**
    
    - 두 개 이상의 포인터나 변수가 동일한 메모리 위치를 참조하는지 여부(별칭)를 파악하는 것입니다. 함수 호출을 통해 포인터가 전달될 때, IPA는 이 포인터가 가리키는 메모리 영역이 무엇인지, 그리고 다른 포인터와 동일한 곳을 가리키는지 분석하여 **널 포인터 역참조(Null Pointer Dereference)**나 **잘못된 메모리 접근** 문제를 탐지합니다.
        
4. **불필요 코드 탐지 (Dead Code Detection):**
    
    - 어떤 함수도 호출하지 않는 함수(미사용 함수)나, 호출되더라도 프로그램의 최종 결과에 영향을 미치지 않는 코드(예: 계산 결과가 버려지는 변수)를 여러 함수 호출 경로를 분석하여 식별합니다.
        
5. **예외 및 에러 처리 분석:**
    
    - 함수 호출 스택을 따라 예외가 어떻게 전파되는지, 또는 에러 코드가 어떻게 처리되는지 분석하여 **예외 미처리**나 **잘못된 에러 핸들링**을 탐지합니다.
        

**CSA에서 IPA의 구현 방식:**

- **호출 그래프(Call Graph) 생성:** 프로그램 내의 모든 함수와 그들 사이의 호출 관계를 나타내는 그래프를 먼저 구축합니다. IPA는 이 호출 그래프를 기반으로 분석을 수행합니다.
    
- **컨텍스트 민감성(Context Sensitivity):** 함수가 어떤 인수로, 어떤 호출 지점에서 호출되었는지에 따라 함수의 동작을 다르게 분석하여 불필요한 경고(false positives)를 줄이고 분석의 정확도를 높입니다. 이는 `foo(10)`과 `foo(0)`이 다르게 동작할 수 있음을 고려하는 것입니다.
    
- **도달 가능한 경로 분석(Reachable Path Analysis):** 특정 버그가 발생할 수 있는 실행 경로가 실제 프로그램에서 도달 가능한 경로인지를 IPA를 통해 확인합니다.
    

### 어려움 (CSA에서의 맥락)

- **높은 계산 비용:** 프로그램 규모가 커질수록 호출 그래프와 데이터 흐름이 복잡해져 분석 시간이 기하급수적으로 늘어납니다.
    
- **별칭 문제:** 포인터나 참조가 복잡하게 얽혀 있을 때 정확한 별칭 분석은 매우 어렵습니다. 이는 수많은 거짓 경고(false positives)나 중요한 버그를 놓치는(false negatives) 원인이 됩니다.
    
- **동적 특징:** 런타임에 결정되는 함수 포인터, 리플렉션, 동적 로딩 등은 정적 분석의 정확도를 떨어뜨리는 주요 요인입니다.
    
- **정확성 vs. 실용성:** 모든 가능한 실행 경로를 완벽하게 분석하는 것은 불가능에 가깝기 때문에, 분석의 '정확성(soundness)'과 '정밀성(precision)' 사이에서 실용적인 균형을 찾아야 합니다.